[2025-05-31T14:55:01.000+0000] {local_task_job_runner.py:123} INFO - ::group::Pre task execution logs
[2025-05-31T14:55:01.029+0000] {taskinstance.py:2612} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: log_monitoring_dag.start_log_producer scheduled__2025-05-31T14:50:00+00:00 [queued]>
[2025-05-31T14:55:01.043+0000] {taskinstance.py:2612} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: log_monitoring_dag.start_log_producer scheduled__2025-05-31T14:50:00+00:00 [queued]>
[2025-05-31T14:55:01.044+0000] {taskinstance.py:2865} INFO - Starting attempt 1 of 2
[2025-05-31T14:55:01.073+0000] {taskinstance.py:2888} INFO - Executing <Task(BashOperator): start_log_producer> on 2025-05-31 14:50:00+00:00
[2025-05-31T14:55:01.088+0000] {logging_mixin.py:190} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:70 DeprecationWarning: This process (pid=365) is multi-threaded, use of fork() may lead to deadlocks in the child.
[2025-05-31T14:55:01.087+0000] {standard_task_runner.py:104} INFO - Running: ['***', 'tasks', 'run', 'log_monitoring_dag', 'start_log_producer', 'scheduled__2025-05-31T14:50:00+00:00', '--job-id', '185', '--raw', '--subdir', 'DAGS_FOLDER/log_monitoring_dag.py', '--cfg-path', '/tmp/tmp4ez43u1i']
[2025-05-31T14:55:01.282+0000] {standard_task_runner.py:105} INFO - Job 185: Subtask start_log_producer
[2025-05-31T14:55:01.282+0000] {standard_task_runner.py:72} INFO - Started process 366 to run task
[2025-05-31T14:55:03.001+0000] {logging_mixin.py:190} WARNING - /home/***/.local/lib/python3.12/site-packages/***/settings.py:209 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2025-05-31T14:55:03.200+0000] {task_command.py:467} INFO - Running <TaskInstance: log_monitoring_dag.start_log_producer scheduled__2025-05-31T14:50:00+00:00 [running]> on host 1d31c4e9dbe9
[2025-05-31T14:55:03.202+0000] {logging_mixin.py:190} WARNING - /home/***/.local/lib/python3.12/site-packages/***/settings.py:470 DeprecationWarning: The sql_alchemy_conn option in [core] has been moved to the sql_alchemy_conn option in [database] - the old setting has been used, but please update your config.
[2025-05-31T14:55:03.704+0000] {taskinstance.py:3131} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='log_monitoring_dag' AIRFLOW_CTX_TASK_ID='start_log_producer' AIRFLOW_CTX_EXECUTION_DATE='2025-05-31T14:50:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-05-31T14:50:00+00:00'
[2025-05-31T14:55:03.706+0000] {taskinstance.py:731} INFO - ::endgroup::
[2025-05-31T14:55:03.764+0000] {subprocess.py:63} INFO - Tmp dir root location: /tmp
[2025-05-31T14:55:03.767+0000] {subprocess.py:75} INFO - Running command: ['/usr/bin/bash', '-c', 'cd /opt/***/app && python -u log_producer.py']
[2025-05-31T14:55:03.781+0000] {subprocess.py:86} INFO - Output:
[2025-05-31T14:55:06.836+0000] {subprocess.py:93} INFO - Sending log: {'timestamp': '2025-05-31 14:55:06', 'level': 'INFO', 'message': 'Page loaded'}
[2025-05-31T14:55:08.942+0000] {subprocess.py:93} INFO - Sending log: {'timestamp': '2025-05-31 14:55:08', 'level': 'ERROR', 'message': 'Payment gateway timeout'}
[2025-05-31T14:55:10.942+0000] {subprocess.py:93} INFO - Sending log: {'timestamp': '2025-05-31 14:55:10', 'level': 'INFO', 'message': 'Search executed'}
[2025-05-31T14:55:12.942+0000] {subprocess.py:93} INFO - Sending log: {'timestamp': '2025-05-31 14:55:12', 'level': 'ERROR', 'message': 'Database connection failed'}
[2025-05-31T14:55:14.943+0000] {subprocess.py:93} INFO - Sending log: {'timestamp': '2025-05-31 14:55:14', 'level': 'ERROR', 'message': 'Payment gateway timeout'}
[2025-05-31T14:55:16.943+0000] {subprocess.py:93} INFO - Sending log: {'timestamp': '2025-05-31 14:55:16', 'level': 'INFO', 'message': 'Search executed'}
[2025-05-31T14:55:18.944+0000] {subprocess.py:93} INFO - Sending log: {'timestamp': '2025-05-31 14:55:18', 'level': 'ERROR', 'message': 'Database connection failed'}
[2025-05-31T14:55:20.945+0000] {subprocess.py:93} INFO - Sending log: {'timestamp': '2025-05-31 14:55:20', 'level': 'WARNING', 'message': 'High memory usage'}
[2025-05-31T14:55:22.945+0000] {subprocess.py:93} INFO - Sending log: {'timestamp': '2025-05-31 14:55:22', 'level': 'ERROR', 'message': 'Payment gateway timeout'}
[2025-05-31T14:55:24.946+0000] {subprocess.py:93} INFO - Sending log: {'timestamp': '2025-05-31 14:55:24', 'level': 'ERROR', 'message': 'Payment gateway timeout'}
[2025-05-31T14:55:26.945+0000] {subprocess.py:93} INFO - Sending log: {'timestamp': '2025-05-31 14:55:26', 'level': 'ERROR', 'message': 'Payment gateway timeout'}
[2025-05-31T14:55:28.946+0000] {subprocess.py:93} INFO - Sending log: {'timestamp': '2025-05-31 14:55:28', 'level': 'WARNING', 'message': 'High memory usage'}
[2025-05-31T14:55:30.947+0000] {subprocess.py:93} INFO - Sending log: {'timestamp': '2025-05-31 14:55:30', 'level': 'WARNING', 'message': 'High memory usage'}
[2025-05-31T14:55:32.947+0000] {subprocess.py:93} INFO - Sending log: {'timestamp': '2025-05-31 14:55:32', 'level': 'ERROR', 'message': 'Database connection failed'}
[2025-05-31T14:55:34.948+0000] {subprocess.py:93} INFO - Sending log: {'timestamp': '2025-05-31 14:55:34', 'level': 'ERROR', 'message': 'Payment gateway timeout'}
[2025-05-31T14:55:36.948+0000] {subprocess.py:93} INFO - Sending log: {'timestamp': '2025-05-31 14:55:36', 'level': 'INFO', 'message': 'Page loaded'}
[2025-05-31T14:55:38.949+0000] {subprocess.py:93} INFO - Sending log: {'timestamp': '2025-05-31 14:55:38', 'level': 'WARNING', 'message': 'Slow response time'}
[2025-05-31T14:55:40.949+0000] {subprocess.py:93} INFO - Sending log: {'timestamp': '2025-05-31 14:55:40', 'level': 'ERROR', 'message': 'Database connection failed'}
[2025-05-31T14:55:42.949+0000] {subprocess.py:93} INFO - Sending log: {'timestamp': '2025-05-31 14:55:42', 'level': 'INFO', 'message': 'Page loaded'}
[2025-05-31T14:55:44.951+0000] {subprocess.py:93} INFO - Sending log: {'timestamp': '2025-05-31 14:55:44', 'level': 'WARNING', 'message': 'High memory usage'}
[2025-05-31T14:55:46.951+0000] {subprocess.py:93} INFO - Sending log: {'timestamp': '2025-05-31 14:55:46', 'level': 'INFO', 'message': 'Page loaded'}
[2025-05-31T14:55:48.952+0000] {subprocess.py:93} INFO - Sending log: {'timestamp': '2025-05-31 14:55:48', 'level': 'ERROR', 'message': 'Payment gateway timeout'}
[2025-05-31T14:55:50.952+0000] {subprocess.py:93} INFO - Sending log: {'timestamp': '2025-05-31 14:55:50', 'level': 'WARNING', 'message': 'Slow response time'}
[2025-05-31T14:55:52.953+0000] {subprocess.py:93} INFO - Sending log: {'timestamp': '2025-05-31 14:55:52', 'level': 'WARNING', 'message': 'High memory usage'}
[2025-05-31T14:55:54.953+0000] {subprocess.py:93} INFO - Sending log: {'timestamp': '2025-05-31 14:55:54', 'level': 'INFO', 'message': 'User logged in'}
[2025-05-31T14:55:56.952+0000] {subprocess.py:93} INFO - Sending log: {'timestamp': '2025-05-31 14:55:56', 'level': 'WARNING', 'message': 'Slow response time'}
[2025-05-31T14:55:58.953+0000] {subprocess.py:93} INFO - Sending log: {'timestamp': '2025-05-31 14:55:58', 'level': 'ERROR', 'message': 'Database connection failed'}
[2025-05-31T14:56:00.953+0000] {subprocess.py:93} INFO - Sending log: {'timestamp': '2025-05-31 14:56:00', 'level': 'INFO', 'message': 'User logged in'}
[2025-05-31T14:56:02.954+0000] {subprocess.py:93} INFO - Sending log: {'timestamp': '2025-05-31 14:56:02', 'level': 'ERROR', 'message': 'Database connection failed'}
[2025-05-31T14:56:04.954+0000] {subprocess.py:93} INFO - Sending log: {'timestamp': '2025-05-31 14:56:04', 'level': 'WARNING', 'message': 'High memory usage'}
[2025-05-31T14:56:06.955+0000] {subprocess.py:93} INFO - Sending log: {'timestamp': '2025-05-31 14:56:06', 'level': 'INFO', 'message': 'Search executed'}
[2025-05-31T14:56:08.955+0000] {subprocess.py:93} INFO - Sending log: {'timestamp': '2025-05-31 14:56:08', 'level': 'WARNING', 'message': 'Slow response time'}
[2025-05-31T14:56:10.955+0000] {subprocess.py:93} INFO - Sending log: {'timestamp': '2025-05-31 14:56:10', 'level': 'ERROR', 'message': 'Payment gateway timeout'}
[2025-05-31T14:56:12.956+0000] {subprocess.py:93} INFO - Sending log: {'timestamp': '2025-05-31 14:56:12', 'level': 'ERROR', 'message': 'Database connection failed'}
[2025-05-31T14:56:14.956+0000] {subprocess.py:93} INFO - Sending log: {'timestamp': '2025-05-31 14:56:14', 'level': 'WARNING', 'message': 'Slow response time'}
[2025-05-31T14:56:16.956+0000] {subprocess.py:93} INFO - Sending log: {'timestamp': '2025-05-31 14:56:16', 'level': 'INFO', 'message': 'Page loaded'}
[2025-05-31T14:56:18.957+0000] {subprocess.py:93} INFO - Sending log: {'timestamp': '2025-05-31 14:56:18', 'level': 'INFO', 'message': 'Search executed'}
[2025-05-31T14:56:22.403+0000] {subprocess.py:93} INFO - Sending log: {'timestamp': '2025-05-31 14:56:22', 'level': 'INFO', 'message': 'User logged in'}
[2025-05-31T14:56:25.831+0000] {subprocess.py:93} INFO - Sending log: {'timestamp': '2025-05-31 14:56:25', 'level': 'INFO', 'message': 'Search executed'}
[2025-05-31T14:56:27.421+0000] {job.py:229} INFO - Heartbeat recovered after 14.48 seconds
[2025-05-31T15:27:01.611+0000] {local_task_job_runner.py:228} ERROR - Heartbeat time limit exceeded!
[2025-05-31T15:27:01.688+0000] {local_task_job_runner.py:245} INFO - ::endgroup::
[2025-05-31T15:27:02.587+0000] {subprocess.py:93} INFO - Sending log: {'timestamp': '2025-05-31 15:27:02', 'level': 'ERROR', 'message': 'Database connection failed'}
[2025-05-31T15:27:04.777+0000] {subprocess.py:93} INFO - Sending log: {'timestamp': '2025-05-31 15:27:04', 'level': 'WARNING', 'message': 'High memory usage'}
[2025-05-31T15:27:07.015+0000] {subprocess.py:93} INFO - Sending log: {'timestamp': '2025-05-31 15:27:06', 'level': 'ERROR', 'message': 'Database connection failed'}
[2025-05-31T15:27:09.069+0000] {subprocess.py:93} INFO - Sending log: {'timestamp': '2025-05-31 15:27:09', 'level': 'INFO', 'message': 'User logged in'}
[2025-05-31T15:27:11.134+0000] {subprocess.py:93} INFO - Sending log: {'timestamp': '2025-05-31 15:27:11', 'level': 'WARNING', 'message': 'Slow response time'}
[2025-05-31T15:27:13.980+0000] {subprocess.py:93} INFO - Sending log: {'timestamp': '2025-05-31 15:27:13', 'level': 'WARNING', 'message': 'Slow response time'}
[2025-05-31T15:27:15.602+0000] {subprocess.py:93} INFO - Sending log: {'timestamp': '2025-05-31 15:27:15', 'level': 'INFO', 'message': 'User logged in'}
[2025-05-31T15:27:23.389+0000] {subprocess.py:93} INFO - Sending log: {'timestamp': '2025-05-31 15:27:18', 'level': 'WARNING', 'message': 'High memory usage'}
[2025-05-31T15:27:24.182+0000] {subprocess.py:93} INFO - Sending log: {'timestamp': '2025-05-31 15:27:23', 'level': 'WARNING', 'message': 'High memory usage'}
[2025-05-31T15:27:26.096+0000] {subprocess.py:93} INFO - Sending log: {'timestamp': '2025-05-31 15:27:26', 'level': 'WARNING', 'message': 'High memory usage'}
[2025-05-31T15:27:28.254+0000] {subprocess.py:93} INFO - Sending log: {'timestamp': '2025-05-31 15:27:28', 'level': 'ERROR', 'message': 'Payment gateway timeout'}
[2025-05-31T15:27:35.517+0000] {subprocess.py:93} INFO - Sending log: {'timestamp': '2025-05-31 15:27:33', 'level': 'INFO', 'message': 'Page loaded'}
[2025-05-31T15:27:35.693+0000] {subprocess.py:93} INFO - Sending log: {'timestamp': '2025-05-31 15:27:35', 'level': 'WARNING', 'message': 'Slow response time'}
[2025-05-31T15:27:38.502+0000] {subprocess.py:93} INFO - Sending log: {'timestamp': '2025-05-31 15:27:37', 'level': 'INFO', 'message': 'Page loaded'}
[2025-05-31T15:27:40.419+0000] {subprocess.py:93} INFO - Sending log: {'timestamp': '2025-05-31 15:27:40', 'level': 'ERROR', 'message': 'Database connection failed'}
[2025-05-31T15:27:42.395+0000] {subprocess.py:93} INFO - Sending log: {'timestamp': '2025-05-31 15:27:42', 'level': 'ERROR', 'message': 'Database connection failed'}
[2025-05-31T15:27:44.488+0000] {subprocess.py:93} INFO - Sending log: {'timestamp': '2025-05-31 15:27:44', 'level': 'INFO', 'message': 'Page loaded'}
[2025-05-31T15:27:47.827+0000] {subprocess.py:93} INFO - Sending log: {'timestamp': '2025-05-31 15:27:47', 'level': 'ERROR', 'message': 'Payment gateway timeout'}
[2025-05-31T15:27:49.517+0000] {subprocess.py:93} INFO - Sending log: {'timestamp': '2025-05-31 15:27:49', 'level': 'INFO', 'message': 'Search executed'}
[2025-05-31T15:27:51.588+0000] {subprocess.py:93} INFO - Sending log: {'timestamp': '2025-05-31 15:27:51', 'level': 'WARNING', 'message': 'Slow response time'}
[2025-05-31T15:27:54.218+0000] {subprocess.py:93} INFO - Sending log: {'timestamp': '2025-05-31 15:27:54', 'level': 'ERROR', 'message': 'Database connection failed'}
[2025-05-31T15:27:56.794+0000] {subprocess.py:93} INFO - Sending log: {'timestamp': '2025-05-31 15:27:56', 'level': 'WARNING', 'message': 'Slow response time'}
[2025-05-31T15:27:58.713+0000] {subprocess.py:93} INFO - Sending log: {'timestamp': '2025-05-31 15:27:58', 'level': 'WARNING', 'message': 'Slow response time'}
[2025-05-31T15:28:02.013+0000] {subprocess.py:93} INFO - Sending log: {'timestamp': '2025-05-31 15:28:01', 'level': 'ERROR', 'message': 'Database connection failed'}
[2025-05-31T15:28:05.984+0000] {subprocess.py:93} INFO - Sending log: {'timestamp': '2025-05-31 15:28:05', 'level': 'ERROR', 'message': 'Database connection failed'}
[2025-05-31T15:28:08.458+0000] {subprocess.py:93} INFO - Sending log: {'timestamp': '2025-05-31 15:28:08', 'level': 'ERROR', 'message': 'Database connection failed'}
[2025-05-31T15:28:10.484+0000] {subprocess.py:93} INFO - Sending log: {'timestamp': '2025-05-31 15:28:10', 'level': 'INFO', 'message': 'User logged in'}
[2025-05-31T15:28:13.101+0000] {subprocess.py:93} INFO - Sending log: {'timestamp': '2025-05-31 15:28:12', 'level': 'INFO', 'message': 'Page loaded'}
[2025-05-31T15:28:15.500+0000] {subprocess.py:93} INFO - Sending log: {'timestamp': '2025-05-31 15:28:14', 'level': 'INFO', 'message': 'Page loaded'}
[2025-05-31T15:28:17.288+0000] {subprocess.py:93} INFO - Sending log: {'timestamp': '2025-05-31 15:28:17', 'level': 'WARNING', 'message': 'High memory usage'}
[2025-05-31T15:28:20.240+0000] {subprocess.py:93} INFO - Sending log: {'timestamp': '2025-05-31 15:28:19', 'level': 'INFO', 'message': 'User logged in'}
[2025-05-31T15:28:22.002+0000] {subprocess.py:93} INFO - Sending log: {'timestamp': '2025-05-31 15:28:21', 'level': 'INFO', 'message': 'Page loaded'}
[2025-05-31T15:28:25.537+0000] {subprocess.py:93} INFO - Sending log: {'timestamp': '2025-05-31 15:28:25', 'level': 'ERROR', 'message': 'Payment gateway timeout'}
[2025-05-31T15:28:29.460+0000] {subprocess.py:93} INFO - Sending log: {'timestamp': '2025-05-31 15:28:28', 'level': 'ERROR', 'message': 'Payment gateway timeout'}
[2025-05-31T15:28:31.611+0000] {process_utils.py:132} INFO - Sending 15 to group 366. PIDs of all processes in the group: [368, 366]
[2025-05-31T15:28:31.612+0000] {subprocess.py:93} INFO - Sending log: {'timestamp': '2025-05-31 15:28:31', 'level': 'INFO', 'message': 'User logged in'}
[2025-05-31T15:28:31.774+0000] {process_utils.py:87} INFO - Sending the signal 15 to group 366
[2025-05-31T15:28:31.775+0000] {taskinstance.py:3092} ERROR - Received SIGTERM. Terminating subprocesses.
[2025-05-31T15:28:32.863+0000] {subprocess.py:104} INFO - Sending SIGTERM signal to process group
[2025-05-31T15:28:41.534+0000] {taskinstance.py:3310} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 767, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 733, in _execute_callable
    return ExecutionCallableRunner(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/operator_helpers.py", line 252, in run
    return self.func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py", line 406, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/operators/bash.py", line 240, in execute
    result = self.subprocess_hook.run_command(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/hooks/subprocess.py", line 91, in run_command
    for raw_line in iter(self.sub_process.stdout.readline, b""):
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 3094, in signal_handler
    raise AirflowTaskTerminated("Task received SIGTERM signal")
airflow.exceptions.AirflowTaskTerminated: Task received SIGTERM signal
[2025-05-31T15:29:26.672+0000] {taskinstance.py:1225} INFO - Marking task as UP_FOR_RETRY. dag_id=log_monitoring_dag, task_id=start_log_producer, run_id=scheduled__2025-05-31T14:50:00+00:00, execution_date=20250531T145000, start_date=20250531T145501, end_date=20250531T152919
[2025-05-31T15:29:31.683+0000] {process_utils.py:150} WARNING - process psutil.Process(pid=366, name='airflow task ru', status='sleeping', started='14:55:00') did not respond to SIGTERM. Trying SIGKILL
[2025-05-31T15:29:46.106+0000] {process_utils.py:150} WARNING - process psutil.Process(pid=368, name='python', status='zombie', started='14:55:02') did not respond to SIGTERM. Trying SIGKILL
[2025-05-31T15:29:46.144+0000] {process_utils.py:87} INFO - Sending the signal 9 to group 366
[2025-05-31T15:29:53.195+0000] {process_utils.py:80} INFO - Process psutil.Process(pid=366, name='airflow task ru', status='terminated', exitcode=<Negsignal.SIGKILL: -9>, started='14:55:00') (366) terminated with exit code -9
[2025-05-31T15:29:54.869+0000] {process_utils.py:80} INFO - Process psutil.Process(pid=368, name='python', status='terminated', started='14:55:02') (368) terminated with exit code None
[2025-05-31T15:30:00.407+0000] {standard_task_runner.py:190} ERROR - ('Job 185 was killed before it finished (likely due to running out of memory)', 'For more information, see https://***.apache.org/docs/apache-***/stable/troubleshooting.html#LocalTaskJob-killed')
[2025-05-31T15:29:54.768+0000] {standard_task_runner.py:217} INFO - Process not found (most likely exited), stop collecting metrics
